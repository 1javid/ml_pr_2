# Airline Passenger Satisfaction Analysis

End-to-end ML study on airline passenger satisfaction data: EDA, binary & multinomial logistic regression, LDA, QDA, NaÃ¯ve Bayes, and regression models. Includes an interactive Streamlit UI that uses the trained models for live predictions.

## Project Structure

```
ML_PR_2/
â”œâ”€â”€ projecttwin.ipynb   # Main notebook: EDA â†’ preprocessing â†’ models â†’ save pickles
â”œâ”€â”€ app.py              # Streamlit UI (loads models from models/ or uses fallback)
â”œâ”€â”€ requirements.txt    # Dependencies for both notebook and app
â”œâ”€â”€ dataset/            # Place train.csv and test.csv here (Kaggle Airline Satisfaction)
â”œâ”€â”€ models/             # Generated by notebook (Section 10) â€” pickled sklearn models & scalers
â”œâ”€â”€ report.tex         # LaTeX source for the report
â””â”€â”€ A2_ML_REPORT.pdf   # Compiled PDF report
```

## Setup

Install dependencies (use the same environment you will use to run the notebook and the app):

```bash
cd ML_PR_2
pip install -r requirements.txt
```

If you use a virtual environment (recommended):

```bash
python -m venv venv
source venv/bin/activate   # Windows: venv\Scripts\activate
pip install -r requirements.txt
```

## Running the Notebook

1. **Data** â€” Put the Kaggle *Airline Passenger Satisfaction* train/test CSVs in `dataset/`:
   - `dataset/train.csv`
   - `dataset/test.csv`

2. **Open and run** the notebook (Jupyter or VS Code). Ensure the kernel uses the environment where you ran `pip install -r requirements.txt`.

   ```bash
   jupyter notebook projecttwin.ipynb
   ```

3. **Run all cells** including the last section (**Section 10**). That creates the `models/` folder with pickled models and scalers. The app uses these for real predictions.

## Running the Interactive App

```bash
streamlit run app.py
```

The app opens at **http://localhost:8501** and has four pages:

| Page | Description |
|------|-------------|
| ğŸ  Overview | Dataset summary, pipeline, key findings |
| ğŸ”® Live Predictor | Enter passenger details; get satisfaction prediction (LDA, QDA, NB, or Logistic Regression if models are loaded) |
| ğŸ“Š Model Comparison | Accuracy, ROC-AUC, F1, ROC curves, classification reports |
| ğŸ“‹ Example Results | Worked examples and confusion matrix |

- **If `models/` exists** (after running the notebook): the app loads the trained sklearn models and uses them for predictions. You can choose which model (LDA, QDA, NaÃ¯ve Bayes, Logistic Regression) to use in the Live Predictor.
- **If `models/` is missing**: the app shows a warning and uses hardcoded logistic-regression coefficients (fallback). Run the notebook and re-run the app to use the real models.

## Models Covered

- **Binary classification** â€” Logistic Regression, LDA, QDA, Gaussian NaÃ¯ve Bayes (target: satisfied vs neutral/dissatisfied)
- **Multinomial classification** â€” Logistic Regression (target: Business / Eco / Eco Plus)
- **Regression** â€” OLS Linear and Poisson GLM (target: flight distance)

## Best Result

LDA with optimal threshold: **87% accuracy**, **ROC-AUC 0.944** on the test set (n = 25,976).
